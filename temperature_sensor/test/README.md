https://github.com/espressif/esp-idf/tree/master/examples/system/unit_test

Run idf.py build and idf.py flash monitor with esp32 connected to run tests.
Esp-idf will automatically find tests in components directory